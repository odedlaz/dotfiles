#!/usr/bin/env fish
set DIR (dirname (readlink -f (status -f)))


function link
	set from $argv[1]
	set to $argv[2]

	# if $from is a file -> link it
	# if $from is a dir, and $to doesn't exist -> link it
	# otherwise, walk $from

   if test -d $from
      if test -e $to; and not test -d $to
         set_color 'red'
         echo "'$from' is a directory, '$to' is not: "(file $to)
         set_color 'normal'
         return 1
      end

      if not test -d $to
         mkdir -p $to
      end

   end

	if test -f $from; or test -d $from;and not test -d $to
		set_color 'yellow'
		rm -v -f $to
		set_color 'normal'
		echo -en "\033[39m"
		ln -v -s $from $to
		return $status
	end

	for path in $from/*
		link $path $to/(basename $path)
	end
end

link "$DIR/fish" "$HOME/.config/fish"

link "$DIR/nvimrc" "$HOME/.vimrc"
link "$DIR/nvimrc" "$HOME/.config/nvim/init.vim"

link "$DIR/tmux" "$HOME/.tmux"
link "$DIR/tmux/tmux.conf" "$HOME/.tmux.conf"

link "$DIR/redshift.conf" "$HOME/.config/redshift.conf"
